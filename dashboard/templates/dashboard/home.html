<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8">
  <title>Harga Satuan – Rencanakan</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background:#f7f9fb; font-family: Arial, sans-serif; color:#333; }
    .navbar{ background:#fff; box-shadow:0 2px 4px rgba(0,0,0,.05); }
    .navbar-brand{ font-weight:600; color:#003366!important; position:absolute; left:50%; transform:translateX(-50%); }
    .navbar-right{ margin-left:auto; }
    .content-wrapper{ margin-top:30px; }
    .card{ border:none; border-radius:14px; box-shadow:0 2px 10px rgba(0,0,0,.06); }
    .table thead{ background:#fff; border-bottom:2px solid #e9ecef; }
    .table th{ border:none; color:#444; font-weight:600; }
    .table td{ vertical-align: middle; border-color:#f1f3f5; }
    .btn-pill{ border-radius:999px; padding:10px 20px; font-weight:600; }
    .footer{ margin-top:40px; font-size:.85rem; color:#888; text-align:center; }
  </style>
</head>
<body>
  <!-- Top navbar -->
  <nav class="navbar navbar-light bg-white shadow-sm px-4">
    <a class="navbar-brand" href="#">Rencanakan</a>
    <div class="d-flex align-items-center navbar-right">
      <span class="me-2">John Doe</span>
      <img src="https://via.placeholder.com/32" class="rounded-circle" alt="profile">
    </div>
  </nav>

  <div class="container content-wrapper">

    <!-- Flash messages (hide info-level so the blue boxes don't show) -->
    {% if messages %}
      <div class="mb-3">
        {% for m in messages %}
          {% if m.level_tag != 'info' %}
            <div class="alert alert-{{ m.tags|default:'secondary' }} mb-2" role="alert">{{ m }}</div>
          {% endif %}
        {% endfor %}
      </div>
    {% endif %}

    <!-- Search bar -->
    <form action="{% url 'home' %}" method="get" class="mb-4">
      <div class="input-group">
        <input
          type="text"
          name="q"
          class="form-control"
          placeholder="Cari produk (contoh: semen, pasir, batu...)"
          value="{{ request.GET.q|default_if_none:'' }}"
          aria-label="Kata kunci produk"
        >
        <button type="submit" class="btn btn-primary btn-pill">Search</button>
      </div>
    </form>

    <!-- Simple products table -->
    <div class="card">
      <div class="card-body p-0">
        <table class="table table-hover mb-0">
          <thead>
            <tr>
              <th style="width:5%">No.</th>
              <th>Nama Produk</th>
              <th style="width:20%">Harga</th>
              <th style="width:25%">Vendor</th>
            </tr>
          </thead>
          <tbody>
            {% for r in prices %}
              <tr>
                <td>{{ forloop.counter }}</td>
                <td>{{ r.item }}</td>
                <td class="c-price">{{ r.value }}</td>
                <td>{{ r.source|default:"—" }}</td>
              </tr>
            {% empty %}
              <tr>
                <td colspan="4" class="text-center text-muted py-4">No data</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>

    <div class="footer">© 2025 rencanakan.id</div>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Format prices as IDR on the client -->
  <script>
    const idf = new Intl.NumberFormat("id-ID", { style:"currency", currency:"IDR", minimumFractionDigits: 0 });
    document.querySelectorAll(".c-price").forEach(td => {
      const raw = String(td.textContent || "").replace(/[^\d.-]/g,"");
      const num = Number(raw);
      if (isFinite(num)) td.textContent = idf.format(num);
    });
  </script>
</body>
</html>